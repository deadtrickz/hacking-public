## Target Information

| IP               | 192.168.56.22                              |
| ---------------- | ------------------------------------------ |
| Hostname         | CASTLEBLACK                                |
| FQDN             | castelblack.north.sevenkingdoms.local      |
| Function         | WEB, SQL                                   |
| Operating System | Windows Server 2019                        |
| VULN             | HTTP website can be used to upload payload |
|                  |                                            |

## Nmap Enumeration

```sh
sudo nmap -A 192.168.56.22
```
```text
PORT     STATE SERVICE       VERSION
80/tcp   open  http          Microsoft IIS httpd 10.0
|_http-title: Site doesn't have a title (text/html).
| http-methods: 
|_  Potentially risky methods: TRACE
|_http-server-header: Microsoft-IIS/10.0
135/tcp  open  msrpc         Microsoft Windows RPC
139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn
445/tcp  open  microsoft-ds?
1433/tcp open  ms-sql-s      Microsoft SQL Server 2019 15.00.2000.00; RTM
|_ssl-date: 2025-08-05T14:14:17+00:00; 0s from scanner time.
| ms-sql-ntlm-info: 
|   192.168.56.22:1433: 
|     Target_Name: NORTH
|     NetBIOS_Domain_Name: NORTH
|     NetBIOS_Computer_Name: CASTELBLACK
|     DNS_Domain_Name: north.sevenkingdoms.local
|     DNS_Computer_Name: castelblack.north.sevenkingdoms.local
|     DNS_Tree_Name: sevenkingdoms.local
|_    Product_Version: 10.0.17763
| ssl-cert: Subject: commonName=SSL_Self_Signed_Fallback
| Not valid before: 2025-08-05T13:21:33
|_Not valid after:  2055-08-05T13:21:33
| ms-sql-info: 
|   192.168.56.22:1433: 
|     Version: 
|       name: Microsoft SQL Server 2019 RTM
|       number: 15.00.2000.00
|       Product: Microsoft SQL Server 2019
|       Service pack level: RTM
|       Post-SP patches applied: false
|_    TCP port: 1433
3389/tcp open  ms-wbt-server Microsoft Terminal Services
|_ssl-date: 2025-08-05T14:14:17+00:00; 0s from scanner time.
| ssl-cert: Subject: commonName=castelblack.north.sevenkingdoms.local
| Not valid before: 2025-06-11T15:35:06
|_Not valid after:  2025-12-11T15:35:06
| rdp-ntlm-info: 
|   Target_Name: NORTH
|   NetBIOS_Domain_Name: NORTH
|   NetBIOS_Computer_Name: CASTELBLACK
|   DNS_Domain_Name: north.sevenkingdoms.local
|   DNS_Computer_Name: castelblack.north.sevenkingdoms.local
|   DNS_Tree_Name: sevenkingdoms.local
|   Product_Version: 10.0.17763
|_  System_Time: 2025-08-05T14:14:11+00:00
5985/tcp open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_http-title: Not Found
|_http-server-header: Microsoft-HTTPAPI/2.0
5986/tcp open  ssl/http      Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
| ssl-cert: Subject: commonName=VAGRANT
| Subject Alternative Name: DNS:VAGRANT, DNS:vagrant
| Not valid before: 2025-06-10T22:11:56
|_Not valid after:  2028-06-09T22:11:56
|_ssl-date: 2025-08-05T14:14:17+00:00; 0s from scanner time.
|_http-server-header: Microsoft-HTTPAPI/2.0
| tls-alpn: 
|_  http/1.1
|_http-title: Not Found
MAC Address: 00:0C:29:BA:E9:F0 (VMware)
Device type: general purpose
Running: Microsoft Windows 2019
OS CPE: cpe:/o:microsoft:windows_server_2019
OS details: Microsoft Windows Server 2019
Network Distance: 1 hop
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
| smb2-security-mode: 
|   3:1:1: 
|_    Message signing enabled but not required
|_nbstat: NetBIOS name: CASTELBLACK, NetBIOS user: <unknown>, NetBIOS MAC: 00:0c:29:ba:e9:f0 (VMware)
| smb2-time: 
|   date: 2025-08-05T14:14:11
|_  start_date: N/A

TRACEROUTE
HOP RTT     ADDRESS
1   0.48 ms 192.168.56.22
```

### HTTP
- Can be used to upload payload
![](../../../zzAttachments/Pasted%20image%2020250805104124.png)
![](../../../zzAttachments/Pasted%20image%2020250805104335.png)

##### Nikto

```sh
nikto -h 192.168.56.22
```
```text
- Nikto v2.5.0
---------------------------------------------------------------------------
+ Target IP:          192.168.56.22
+ Target Hostname:    192.168.56.22
+ Target Port:        80
+ Start Time:         2025-08-05 11:44:23 (GMT-4)
---------------------------------------------------------------------------
+ Server: Microsoft-IIS/10.0
+ /: Retrieved x-powered-by header: ASP.NET.
+ /: The anti-clickjacking X-Frame-Options header is not present. See: https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options
+ /: The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type. See: https://www.netsparker.com/web-vulnerability-scanner/vulnerabilities/missing-content-type-header/
+ /O3JDNw8r.ashx: Retrieved x-aspnet-version header: 4.0.30319.
+ No CGI Directories found (use '-C all' to force check all possible dirs)
+ Multiple index files found: /index.html, /default.aspx.
+ OPTIONS: Allowed HTTP Methods: OPTIONS, TRACE, GET, HEAD, POST .
+ OPTIONS: Public HTTP Methods: OPTIONS, TRACE, GET, HEAD, POST .
+ 8102 requests: 0 error(s) and 7 item(s) reported on remote host
+ End Time:           2025-08-05 11:44:35 (GMT-4) (12 seconds)
---------------------------------------------------------------------------
+ 1 host(s) tested

```

## Smb

##### smbclient
```sh
smbclient -L //192.168.56.22 -N
```
```text
        Sharename       Type      Comment
        ---------       ----      -------
        ADMIN$          Disk      Remote Admin
        all             Disk      Basic RW share for all
        C$              Disk      Default share
        IPC$            IPC       Remote IPC
        public          Disk      Basic Read share for all domain users
Reconnecting with SMB1 for workgroup listing.
do_connect: Connection to 192.168.56.22 failed (Error NT_STATUS_RESOURCE_NAME_NOT_FOUND)
Unable to connect with SMB1 -- no workgroup available
```

## RPC

##### rpcclient
- unauthenticated
```
rpcclient -U "" 192.168.56.22
```
![](../../../zzAttachments/Pasted%20image%2020250805101026.png)
![](../../../zzAttachments/Pasted%20image%2020250805103531.png)
![](../../../zzAttachments/Pasted%20image%2020250805103712.png)


