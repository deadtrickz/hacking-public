## Target Information

| IP               | 192.168.56.10                    |
| ---------------- | -------------------------------- |
| Hostname         | KINGSLANDING                     |
| FQDN             | kingslanding.sevenkingdoms.local |
| Function         | Domain Controller                |
| Operating System | Windows Server 2019              |

## Nmap Enumeration

```sh
sudo nmap -A 192.168.56.10
```
```text
PORT     STATE SERVICE       VERSION
53/tcp   open  domain        Simple DNS Plus
80/tcp   open  http          Microsoft IIS httpd 10.0
| http-methods: 
|_  Potentially risky methods: TRACE
|_http-title: IIS Windows Server
|_http-server-header: Microsoft-IIS/10.0
88/tcp   open  kerberos-sec  Microsoft Windows Kerberos (server time: 2025-08-05 14:03:10Z)
135/tcp  open  msrpc         Microsoft Windows RPC
139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn
389/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: sevenkingdoms.local0., Site: Default-First-Site-Name)
| ssl-cert: Subject: commonName=kingslanding.sevenkingdoms.local
| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1:<unsupported>, DNS:kingslanding.sevenkingdoms.local
| Not valid before: 2025-06-12T15:45:44
|_Not valid after:  2026-06-12T15:45:44
|_ssl-date: 2025-08-05T14:03:58+00:00; 0s from scanner time.
445/tcp  open  microsoft-ds?
464/tcp  open  kpasswd5?
593/tcp  open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
636/tcp  open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: sevenkingdoms.local0., Site: Default-First-Site-Name)
| ssl-cert: Subject: commonName=kingslanding.sevenkingdoms.local
| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1:<unsupported>, DNS:kingslanding.sevenkingdoms.local
| Not valid before: 2025-06-12T15:45:44
|_Not valid after:  2026-06-12T15:45:44
|_ssl-date: 2025-08-05T14:03:58+00:00; 0s from scanner time.
3268/tcp open  ldap          Microsoft Windows Active Directory LDAP (Domain: sevenkingdoms.local0., Site: Default-First-Site-Name)
|_ssl-date: 2025-08-05T14:03:58+00:00; 0s from scanner time.
| ssl-cert: Subject: commonName=kingslanding.sevenkingdoms.local
| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1:<unsupported>, DNS:kingslanding.sevenkingdoms.local
| Not valid before: 2025-06-12T15:45:44
|_Not valid after:  2026-06-12T15:45:44
3269/tcp open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: sevenkingdoms.local0., Site: Default-First-Site-Name)
|_ssl-date: 2025-08-05T14:03:58+00:00; 0s from scanner time.
| ssl-cert: Subject: commonName=kingslanding.sevenkingdoms.local
| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1:<unsupported>, DNS:kingslanding.sevenkingdoms.local
| Not valid before: 2025-06-12T15:45:44
|_Not valid after:  2026-06-12T15:45:44
3389/tcp open  ms-wbt-server Microsoft Terminal Services
| rdp-ntlm-info: 
|   Target_Name: SEVENKINGDOMS
|   NetBIOS_Domain_Name: SEVENKINGDOMS
|   NetBIOS_Computer_Name: KINGSLANDING
|   DNS_Domain_Name: sevenkingdoms.local
|   DNS_Computer_Name: kingslanding.sevenkingdoms.local
|   DNS_Tree_Name: sevenkingdoms.local
|   Product_Version: 10.0.17763
|_  System_Time: 2025-08-05T14:03:50+00:00
|_ssl-date: 2025-08-05T14:03:58+00:00; 0s from scanner time.
| ssl-cert: Subject: commonName=kingslanding.sevenkingdoms.local
| Not valid before: 2025-06-11T05:37:14
|_Not valid after:  2025-12-11T05:37:14
5985/tcp open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_http-server-header: Microsoft-HTTPAPI/2.0
|_http-title: Not Found
5986/tcp open  ssl/http      Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_ssl-date: 2025-08-05T14:03:58+00:00; 0s from scanner time.
|_http-title: Not Found
|_http-server-header: Microsoft-HTTPAPI/2.0
| tls-alpn: 
|_  http/1.1
| ssl-cert: Subject: commonName=VAGRANT
| Subject Alternative Name: DNS:VAGRANT, DNS:vagrant
| Not valid before: 2025-06-10T22:04:59
|_Not valid after:  2028-06-09T22:04:59
MAC Address: 00:0C:29:FF:C6:A6 (VMware)
Device type: general purpose
Running: Microsoft Windows 2019
OS CPE: cpe:/o:microsoft:windows_server_2019
OS details: Microsoft Windows Server 2019
Network Distance: 1 hop
Service Info: Host: KINGSLANDING; OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
| smb2-security-mode: 
|   3:1:1: 
|_    Message signing enabled and required
| smb2-time: 
|   date: 2025-08-05T14:03:50
|_  start_date: N/A
|_nbstat: NetBIOS name: KINGSLANDING, NetBIOS user: <unknown>, NetBIOS MAC: 00:0c:29:ff:c6:a6 (VMware)

TRACEROUTE
HOP RTT     ADDRESS
1   0.89 ms 192.168.56.10
```

## Automated Enumeration

##### enum4linux
```
enum4linux 192.168.56.10
Starting enum4linux v0.9.1 ( http://labs.portcullis.co.uk/application/enum4linux/ ) on Tue Aug  5 12:03:51 2025

 =========================================( Target Information )=========================================

Target ........... 192.168.56.10
RID Range ........ 500-550,1000-1050
Username ......... ''
Password ......... ''
Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none


 ===========================( Enumerating Workgroup/Domain on 192.168.56.10 )===========================


[+] Got domain/workgroup name: SEVENKINGDOMS


 ===============================( Nbtstat Information for 192.168.56.10 )===============================

Looking up status of 192.168.56.10
        SEVENKINGDOMS   <1c> - <GROUP> B <ACTIVE>  Domain Controllers
        KINGSLANDING    <00> -         B <ACTIVE>  Workstation Service
        SEVENKINGDOMS   <00> - <GROUP> B <ACTIVE>  Domain/Workgroup Name
        KINGSLANDING    <20> -         B <ACTIVE>  File Server Service
        SEVENKINGDOMS   <1b> -         B <ACTIVE>  Domain Master Browser

        MAC Address = 00-0C-29-FF-C6-A6

 ===================================( Session Check on 192.168.56.10 )===================================


[+] Server 192.168.56.10 allows sessions using username '', password ''


 ================================( Getting domain SID for 192.168.56.10 )================================

Domain Name: SEVENKINGDOMS
Domain Sid: S-1-5-21-410066919-758230338-2640804713

[+] Host is part of a domain (not a workgroup)


 ==================================( OS information on 192.168.56.10 )==================================


[E] Can't get OS info with smbclient


[+] Got OS info for 192.168.56.10 from srvinfo: 
do_cmd: Could not initialise srvsvc. Error was NT_STATUS_ACCESS_DENIED


 =======================================( Users on 192.168.56.10 )=======================================


[E] Couldn't find users using querydispinfo: NT_STATUS_ACCESS_DENIED
                                                                                                                                                                                                    
                                                                                                                                                                                                    

[E] Couldn't find users using enumdomusers: NT_STATUS_ACCESS_DENIED                                                                                                                                 
                                                                                                                                                                                                    
                                                                                                                                                                                                    
 =================================( Share Enumeration on 192.168.56.10 )=================================
                                                                                                                                                                                                    
do_connect: Connection to 192.168.56.10 failed (Error NT_STATUS_RESOURCE_NAME_NOT_FOUND)                                                                                                            

        Sharename       Type      Comment
        ---------       ----      -------
Reconnecting with SMB1 for workgroup listing.
Unable to connect with SMB1 -- no workgroup available

[+] Attempting to map shares on 192.168.56.10                                                                                                                                                       
                                                                                                                                                                                                    
                                                                                                                                                                                                    
 ===========================( Password Policy Information for 192.168.56.10 )===========================
                                                                                                                                                                                                    
                                                                                                                                                                                                    
[E] Unexpected error from polenum:                                                                                                                                                                  
                                                                                                                                                                                                    
                                                                                                                                                                                                    

[+] Attaching to 192.168.56.10 using a NULL share

[+] Trying protocol 139/SMB...

        [!] Protocol failed: Cannot request session (Called Name:192.168.56.10)

[+] Trying protocol 445/SMB...

        [!] Protocol failed: SAMR SessionError: code: 0xc0000022 - STATUS_ACCESS_DENIED - {Access Denied} A process has requested access to an object but has not been granted those access rights.



[E] Failed to get password policy with rpcclient                                                                                                                                                    
                                                                                                                                                                                                    
                                                                                                                                                                                                    

 ======================================( Groups on 192.168.56.10 )======================================
                                                                                                                                                                                                    
                                                                                                                                                                                                    
[+] Getting builtin groups:                                                                                                                                                                         
                                                                                                                                                                                                    
                                                                                                                                                                                                    
[+]  Getting builtin group memberships:                                                                                                                                                             
                                                                                                                                                                                                    
                                                                                                                                                                                                    
[+]  Getting local groups:                                                                                                                                                                          
                                                                                                                                                                                                    
                                                                                                                                                                                                    
[+]  Getting local group memberships:                                                                                                                                                               
                                                                                                                                                                                                    
                                                                                                                                                                                                    
[+]  Getting domain groups:                                                                                                                                                                         
                                                                                                                                                                                                    
                                                                                                                                                                                                    
[+]  Getting domain group memberships:                                                                                                                                                              
                                                                                                                                                                                                    
                                                                                                                                                                                                    
 ==================( Users on 192.168.56.10 via RID cycling (RIDS: 500-550,1000-1050) )==================
                                                                                                                                                                                                    
                                                                                                                                                                                                    
[E] Couldn't get SID: NT_STATUS_ACCESS_DENIED.  RID cycling not possible.                                                                                                                           
                                                                                                                                                                                                    
                                                                                                                                                                                                    
 ===============================( Getting printer info for 192.168.56.10 )===============================
                                                                                                                                                                                                    
do_cmd: Could not initialise spoolss. Error was NT_STATUS_ACCESS_DENIED                                                                                                                             


enum4linux complete on Tue Aug  5 12:03:52 2025
```

## Manual Enumeration

#### Port 80
![](../../../zzAttachments/Pasted%20image%2020250805093420.png)

##### nikto
```sh
nikto -h 192.168.56.10:80
```
```text
- Nikto v2.5.0
---------------------------------------------------------------------------
+ Target IP:          192.168.56.10
+ Target Hostname:    192.168.56.10
+ Target Port:        80
+ Start Time:         2025-08-05 10:34:41 (GMT-4)
---------------------------------------------------------------------------
+ Server: Microsoft-IIS/10.0
+ /: Retrieved x-powered-by header: ASP.NET.
+ /: The anti-clickjacking X-Frame-Options header is not present. See: https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options
+ /: The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type. See: https://www.netsparker.com/web-vulnerability-scanner/vulnerabilities/missing-content-type-header/
+ /0OYvdvBf.ashx: Retrieved x-aspnet-version header: 4.0.30319.
+ No CGI Directories found (use '-C all' to force check all possible dirs)
+ OPTIONS: Allowed HTTP Methods: OPTIONS, TRACE, GET, HEAD, POST .
+ OPTIONS: Public HTTP Methods: OPTIONS, TRACE, GET, HEAD, POST .
+ 8254 requests: 0 error(s) and 6 item(s) reported on remote host
+ End Time:           2025-08-05 10:34:53 (GMT-4) (12 seconds)
---------------------------------------------------------------------------
+ 1 host(s) tested
```

##### ldapsearch
- needs authentication
```sh
ldapsearch -x -H ldap://192.168.56.10 -b "dc=kingslanding.sevenkingdoms,dc=local"
```
```text
# extended LDIF
#
# LDAPv3
# base <dc=kingslanding.sevenkingdoms,dc=local> with scope subtree
# filter: (objectclass=*)
# requesting: ALL
#

# search result
search: 2
result: 1 Operations error
text: 000004DC: LdapErr: DSID-0C090A5C, comment: In order to perform this opera
 tion a successful bind must be completed on the connection., data 0, v4563

# numResponses: 1
```